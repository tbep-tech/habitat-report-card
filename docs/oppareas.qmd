---
title: "Opportunity Areas in the Tampa Bay Watershed"
author: 
  - name: Dr. Marcus Beck, <mbeck@tbep.org>
institute: "Tampa Bay Estuary Program"
date: "`r Sys.Date()`"
format:
  html:
    theme: cosmo
    code-tools: 
      source: https://github.com/tbep-tech/habitat-report-card/blob/master/docs/oppareas.qmd
    css: styles.css
    page-layout: full

execute:
  echo: false
  warning: false
---

```{r}
#| include: false
library(leaflet)
library(here)
library(sf)

oppmap <- st_read(here('data/oppmap.shp'))

cols <- list(
    `Existing Conservation Native` = 'yellowgreen', 
    `Existing Conservation Restorable` = 'green4', 
    `Proposed Conservation Native` = 'dodgerblue1', 
    `Proposed Conservation Restorable` = 'dodgerblue4', 
    `Reservation Native` = 'violetred1', 
    `Reservation Restorable` = 'violetred3'
    ) |> 
    unlist()
```

The map shows opportunity areas in the Tampa Bay Watershed.  This information is provided to support habitat restoration and protection projects pursued by area partners in the Tampa Bay watershed.  Additional information about the methods used to define these areas can be found in the [Habitat Master Plan](https://tbep.org/habitat-master-plan-update){target="_blank"} and [Beck et al. 2023](https://doi.org/10.3389/fevo.2023.1070266){target="blank"}. The following definitions apply:

| Opportunity Area | Description |
|-----------------|-------------|
| Existing conservation native | Native habitats currently within existing conservation lands |
| Existing conservation restorable | Restorable areas currently within existing conservation lands |
| Proposed conservation native | Native habitats within proposed conservation lands |
| Proposed conservation restorable | Restorable areas within proposed conservation lands |
| Reservation native | Native habitats within the coastal stratum |
| Reservation restorable | Restorable areas within the coastal stratum |

```{r}
#| fig-height: 8
pal <- colorFactor(palette = cols, domain = names(cols))

oppmap |> 
  st_simplify(dTolerance = 100) |>
  st_transform(crs = 4326) |> 
  leaflet() |> 
  addProviderTiles("CartoDB.Positron") |> 
  addPolygons(
    fillColor = ~pal(cat),
    fillOpacity = 0.7,
    color = ~pal(cat),
    weight = 0.5,
    popup = ~paste0(
      '<strong>Opportunity area: </strong>', cat
    )
  ) |> 
  addLegend(
    position = 'topright',
    pal = pal,
    values = oppmap$cat,
    opacity = 0.7,
    title = 'Restoration Potential Type'
  )
```
Note: polygons have been simplified for web display. Contact author for high-resolution data.